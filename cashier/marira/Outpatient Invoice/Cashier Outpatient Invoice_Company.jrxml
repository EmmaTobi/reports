<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.1.1.final using JasperReports Library version 6.1.1  -->
<!-- 2016-08-11T11:38:37 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="cashier-outpatient-invoice" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isIgnorePagination="true" uuid="fe780ab7-fe00-48bf-89f9-30ca2fb097d1">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="marira_live"/>
	<style name="Table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="opd_invoice" uuid="1b24907d-b6b0-42ab-a415-bbf658d22036">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="marira_live"/>
		<parameter name="accountNumber" class="java.lang.String">
			<parameterDescription><![CDATA[]]></parameterDescription>
		</parameter>
		<parameter name="beginDate" class="java.util.Date">
			<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
		</parameter>
		<parameter name="endDate" class="java.util.Date">
			<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
		</parameter>
		<queryString>
			<![CDATA[SELECT
    cb.receipt_number AS BillReceipt,
    DATE_FORMAT(cbp.date_created, '%Y-%m-%d') AS BillDate,
    pi.identifier AS FileNumber,
    concat_ws(' ', pn.given_name, pn.middle_name, pn.family_name) AS PatientName,
    cbp.amount AS BillAmount
    
FROM
    cashier_bill cb
    INNER JOIN cashier_bill_payment cbp ON
    cb.bill_id = cbp.bill_id
    INNER JOIN cashier_bill_payment_attribute cbpa ON
    cbp.bill_payment_id = cbpa.bill_payment_id
    AND cbpa.payment_mode_attribute_type_id = 2
    INNER JOIN person_name pn ON
    cb.patient_id = pn.person_id
    INNER JOIN patient_identifier pi ON
	cb.patient_id = pi.patient_id
	AND
    pi.identifier_type = 3
    
WHERE 
    cbpa.value_reference =  $P{accountNumber} AND
    (cbp.date_created BETWEEN CAST($P{beginDate} AS DATE)  AND CAST($P{endDate} AS DATE))]]>
		</queryString>
		<field name="BillReceipt" class="java.lang.String"/>
		<field name="BillDate" class="java.lang.String"/>
		<field name="FileNumber" class="java.lang.String"/>
		<field name="PatientName" class="java.lang.String"/>
		<field name="BillAmount" class="java.math.BigDecimal"/>
		<variable name="TotalAmount" class="java.math.BigDecimal" calculation="Sum">
			<variableExpression><![CDATA[$F{BillAmount}]]></variableExpression>
			<initialValueExpression><![CDATA[0]]></initialValueExpression>
		</variable>
	</subDataset>
	<parameter name="accountNumber" class="java.lang.String">
		<parameterDescription><![CDATA[]]></parameterDescription>
	</parameter>
	<parameter name="beginDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="endDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
	CASE 
		WHEN value_reference = '43462' THEN 'Kijabe'
		WHEN value_reference = '21011' THEN 'AIDS Relief'
		WHEN value_reference = '67200' THEN 'Rift Valley Academy'
        WHEN value_reference = '60052' THEN "New Hope Children's Center" 
	END AS companyname
    
FROM
	cashier_bill cb
	INNER JOIN cashier_bill_payment cbp ON
    cb.bill_id = cbp.bill_id
    INNER JOIN cashier_bill_payment_attribute cbpa ON
    cbp.bill_payment_id = cbpa.bill_payment_id
    AND cbpa.payment_mode_attribute_type_id = 2
    
WHERE 
    cbpa.value_reference =  $P{accountNumber} AND
    (cbp.date_created BETWEEN CAST($P{beginDate} AS DATE)  AND CAST($P{endDate} AS DATE))
limit 1;]]>
	</queryString>
	<field name="companyname" class="java.lang.String"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="65" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="555" height="32" uuid="7f92f315-aa15-4a5a-966e-4c4f975f9c3f"/>
				<textElement textAlignment="Center">
					<font size="24"/>
				</textElement>
				<text><![CDATA[AIC Kijabe]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="32" width="555" height="32" uuid="55fac814-bfc7-492a-ba42-21f681fa4825"/>
				<textElement textAlignment="Center">
					<font size="22"/>
				</textElement>
				<text><![CDATA[ Marira Invoice]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="31" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="1" width="140" height="23" uuid="a262e2cf-0718-410d-b63e-c3d631f7ef01"/>
				<textElement>
					<font size="16"/>
				</textElement>
				<text><![CDATA[Company Name:]]></text>
			</staticText>
			<textField>
				<reportElement x="141" y="1" width="414" height="23" uuid="8166640c-bb05-4f02-a7ed-37244e090977"/>
				<textElement>
					<font size="16"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{companyname}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="91" splitType="Stretch">
			<componentElement>
				<reportElement x="0" y="0" width="555" height="90" uuid="3a695189-c37d-4084-8467-69196f197f87">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="opd_invoice" uuid="a113bfc8-dd3f-462d-9a6b-685a57493ecd">
						<datasetParameter name="beginDate">
							<datasetParameterExpression><![CDATA[$P{beginDate}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="endDate">
							<datasetParameterExpression><![CDATA[$P{endDate}]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="accountNumber">
							<datasetParameterExpression><![CDATA[$P{accountNumber}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="130" uuid="4d9a46ae-7ec2-4a3c-876e-13beb12df664">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column1"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="130" height="30" uuid="7f3b20f6-5784-4ecf-a10e-789ada95abe1"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Receipt No.]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:columnFooter style="Table_CH" height="30"/>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="130" height="30" uuid="3d0ff405-dbf6-442e-a8d9-47743f10d941"/>
								<textElement verticalAlignment="Middle">
									<font size="11"/>
									<paragraph leftIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{BillReceipt}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="90" uuid="fc352d97-d17a-4727-87a1-d6aab64e8a6e">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column2"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="90" height="30" uuid="84cb7b02-61e5-4b99-8d67-5becdd13ad99"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Date]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:columnFooter style="Table_CH" height="30"/>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="90" height="30" uuid="25caa3da-21f2-4f10-94ba-83d75632583c"/>
								<textElement verticalAlignment="Middle">
									<font size="11"/>
									<paragraph leftIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{BillDate}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="07942b88-683c-41c8-a526-910b8c6b0fdb">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column3"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="80" height="30" uuid="4c94103d-5b60-4ea1-9159-8f21cd447ddf"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Hospital #]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:columnFooter style="Table_CH" height="30"/>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="80" height="30" uuid="e3db7e54-9e32-4bf7-9f89-fb0140f5abb7"/>
								<textElement verticalAlignment="Middle">
									<font size="11"/>
									<paragraph leftIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{FileNumber}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="170" uuid="f75abc42-2795-43c2-8a95-66bcdea7e049">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column4"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="170" height="30" uuid="30b83f5a-6b5e-44f6-b904-52753f06ed56"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Patient Name]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:columnFooter style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="170" height="30" uuid="c44610a9-beec-4773-8f5e-d8b18027674f"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font size="11" isBold="true"/>
								</textElement>
								<text><![CDATA[Total]]></text>
							</staticText>
						</jr:columnFooter>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="170" height="30" uuid="04b655cd-6edf-4fbf-9c98-fd4bb9f7ffc6"/>
								<textElement verticalAlignment="Middle">
									<font size="11"/>
									<paragraph leftIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{PatientName}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="85" uuid="fb264306-6bfd-46c9-8b82-c70eaae4ebad">
						<property name="com.jaspersoft.studio.unit.height" value="pixel"/>
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column5"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="85" height="30" uuid="9862ba83-5024-4348-8287-9060951658ed"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font size="12" isBold="true"/>
								</textElement>
								<text><![CDATA[Amount]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:columnFooter style="Table_CH" height="30">
							<textField>
								<reportElement x="0" y="0" width="85" height="30" uuid="f255ff1f-c1d2-4614-8f76-800c191d10bc"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font size="11" isBold="true"/>
									<paragraph rightIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{TotalAmount}]]></textFieldExpression>
							</textField>
						</jr:columnFooter>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="85" height="30" uuid="4c41bcea-910f-492c-9d64-253dc4e9b4dc"/>
								<textElement textAlignment="Right" verticalAlignment="Middle">
									<font size="11"/>
									<paragraph rightIndent="2"/>
								</textElement>
								<textFieldExpression><![CDATA[$F{BillAmount}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</detail>
	<noData>
		<band height="19">
			<staticText>
				<reportElement x="0" y="1" width="306" height="16" uuid="e168f620-6631-4718-b751-d9fcdc0ad49d"/>
				<textElement textAlignment="Left">
					<font isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[No data was found to display on the report.]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
