<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.1.1.final using JasperReports Library version 6.1.1  -->
<!-- 2016-04-05T14:07:26 -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="InventoryItemsDistributed" pageWidth="595" pageHeight="842" whenNoDataType="NoDataSection" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isIgnorePagination="true" uuid="d01934e8-0fb7-4c8f-9a89-b6bd526c395f">
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Kapsowar"/>
	<style name="Table_TH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_CH" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Table_TD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
		<conditionalStyle>
			<conditionExpression><![CDATA[new Boolean($V{REPORT_COUNT}.intValue()%2==0)]]></conditionExpression>
			<style backcolor="#D0E1F2"/>
		</conditionalStyle>
	</style>
	<subDataset name="DistributedInvData" uuid="c56c0f22-3e22-4d0e-9806-d1a4f465a68e">
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="Kapsowar"/>
		<parameter name="beginDate" class="java.util.Date">
			<parameterDescription><![CDATA[]]></parameterDescription>
			<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
		</parameter>
		<parameter name="endDate" class="java.util.Date">
			<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
		</parameter>
		<parameter name="beginDatePattern" class="java.lang.String" isForPrompting="false">
			<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").format($P{beginDate})]]></defaultValueExpression>
		</parameter>
		<parameter name="endDatePattern" class="java.lang.String" isForPrompting="false">
			<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").format($P{endDate})]]></defaultValueExpression>
		</parameter>
		<parameter name="patientID" class="java.lang.Integer">
			<parameterDescription><![CDATA[]]></parameterDescription>
		</parameter>
		<queryString>
			<![CDATA[SELECT
CONCAT(patient_person_name.given_name, ' ', patient_person_name.family_name) as PatientName,
inv_item.name as InventoryItemName, 
COUNT(inv_trans.transaction_id) as NoOfTransactions, 
ABS(inv_trans.quantity) as QuantityDistributed
FROM inv_transaction AS inv_trans
	INNER JOIN inv_stock_operation inv_sto
	ON inv_trans.operation_id = inv_sto.stock_operation_id
	INNER JOIN inv_item 
	ON inv_item.item_id = inv_trans.item_id
	LEFT OUTER JOIN patient ON
	inv_trans.patient_id = patient.patient_id
	LEFT OUTER JOIN person patient_person ON
	patient.patient_id = patient_person.person_id
    LEFT OUTER JOIN person_name patient_person_name ON
    patient_person.person_id = patient_person_name.person_id AND
    patient_person_name.preferred = 1
WHERE inv_sto.operation_type_id = 3 AND inv_sto.patient_id IS NOT NULL
AND inv_trans.patient_id = $P{patientID} 
AND (inv_trans.date_created BETWEEN  $P{beginDatePattern} AND  $P{endDatePattern} )
GROUP BY inv_item.name;]]>
		</queryString>
		<field name="PatientName" class="java.lang.String"/>
		<field name="InventoryItemName" class="java.lang.String"/>
		<field name="NoOfTransactions" class="java.lang.Long"/>
		<field name="QuantityDistributed" class="java.lang.Long"/>
	</subDataset>
	<parameter name="beginDate" class="java.util.Date">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="endDate" class="java.util.Date">
		<defaultValueExpression><![CDATA[new Date()]]></defaultValueExpression>
	</parameter>
	<parameter name="beginDatePattern" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").format($P{beginDate})]]></defaultValueExpression>
	</parameter>
	<parameter name="endDatePattern" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").format($P{endDate})]]></defaultValueExpression>
	</parameter>
	<parameter name="patientID" class="java.lang.Integer">
		<parameterDescription><![CDATA[]]></parameterDescription>
	</parameter>
	<queryString>
		<![CDATA[SELECT 1;]]>
	</queryString>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="36" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="575" height="32" uuid="c69cf57a-3805-40ff-b6d1-ac61f62e6884"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="24"/>
				</textElement>
				<text><![CDATA[Kapsowar Hospital]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="33" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="575" height="25" uuid="91f01cba-b63b-4416-b07e-4e4eb50613ec"/>
				<textElement>
					<font size="12" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Inventory Item Distribution Report for " + new SimpleDateFormat("yyyy-MMM-dd").format($P{beginDate}) + " to " + new SimpleDateFormat("yyyy-MMM-dd").format($P{endDate})]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<pageFooter>
		<band height="29" splitType="Stretch">
			<textField>
				<reportElement x="0" y="6" width="369" height="16" uuid="72bfd8d1-f29e-4e91-ad01-f4877143609f"/>
				<textElement textAlignment="Left">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Generated at " + new SimpleDateFormat("yyyy-dd-MM HH:mm").format(new Date())]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="494" y="5" width="61" height="20" uuid="b27a755d-fecd-4729-8e14-6b1b042c9e6a"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Page " + $V{PAGE_NUMBER} + " of "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="531" y="5" width="36" height="16" uuid="088857a9-f9c8-4e2f-beb8-5d75ee7c5b2d"/>
				<textElement textAlignment="Right">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="63" splitType="Stretch">
			<componentElement>
				<reportElement x="0" y="0" width="555" height="60" uuid="d01ac313-42d9-485d-9870-69f82cca473b">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
				</reportElement>
				<jr:table xmlns:jr="http://jasperreports.sourceforge.net/jasperreports/components" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports/components http://jasperreports.sourceforge.net/xsd/components.xsd">
					<datasetRun subDataset="DistributedInvData" uuid="227ea83f-9be6-4a49-a306-5bc0d3084714">
						<datasetParameter name="beginDate">
							<datasetParameterExpression><![CDATA[new Date()]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="endDate">
							<datasetParameterExpression><![CDATA[new Date()]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="beginDatePattern">
							<datasetParameterExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").format($P{beginDate})]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="endDatePattern">
							<datasetParameterExpression><![CDATA[new SimpleDateFormat("yyyy-MM-dd").format($P{endDate})]]></datasetParameterExpression>
						</datasetParameter>
						<datasetParameter name="patientID">
							<datasetParameterExpression><![CDATA[$P{patientID}]]></datasetParameterExpression>
						</datasetParameter>
						<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					</datasetRun>
					<jr:column width="160" uuid="3227ebe4-3040-460b-b245-afe4689f3197">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column1"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="160" height="30" uuid="6a3408e1-8798-4add-a694-d942dac0e0cc"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Patient Name]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="160" height="30" uuid="684f9f8c-a9e4-4e6c-9006-576d71d3ee2b"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{PatientName}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="250" uuid="a6f96b02-16cd-4c69-8e4a-7801aab19d92">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column2"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="250" height="30" uuid="a94836e9-f36c-4047-91a1-4bba1723a184"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Inventory Item Name]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="250" height="30" uuid="a3efce08-2224-40b3-b813-07ddfc0a848b"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{InventoryItemName}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="80" uuid="55d7fdb0-ec7b-4eed-b46b-db334a991dad">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column3"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="80" height="30" uuid="b4f7c9dd-ca91-4304-b05b-9934b914f74f"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[No Of Transactions]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="80" height="30" uuid="fd5169d0-2e54-4b89-8354-f88a2e90a9cc"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{NoOfTransactions}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
					<jr:column width="70" uuid="456b938f-dd4d-4cfe-8237-23953a7bf0d6">
						<property name="com.jaspersoft.studio.components.table.model.column.name" value="Column4"/>
						<jr:columnHeader style="Table_CH" height="30">
							<staticText>
								<reportElement x="0" y="0" width="70" height="30" uuid="9f5b8d39-d73e-4de3-992b-276b8810c511"/>
								<textElement textAlignment="Center" verticalAlignment="Middle">
									<font isBold="true"/>
								</textElement>
								<text><![CDATA[Quantity Distributed]]></text>
							</staticText>
						</jr:columnHeader>
						<jr:detailCell style="Table_TD" height="30">
							<textField>
								<reportElement x="0" y="0" width="70" height="30" uuid="6506cc1d-b7d3-4578-9ff6-142d04c49df1"/>
								<textElement textAlignment="Center" verticalAlignment="Middle"/>
								<textFieldExpression><![CDATA[$F{QuantityDistributed}]]></textFieldExpression>
							</textField>
						</jr:detailCell>
					</jr:column>
				</jr:table>
			</componentElement>
		</band>
	</summary>
	<noData>
		<band height="27">
			<staticText>
				<reportElement x="0" y="5" width="306" height="16" uuid="264ddf73-6fe8-4e8f-8dc3-f9eb2462e7c4"/>
				<textElement textAlignment="Left">
					<font isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[No data was found to display on the report.]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
